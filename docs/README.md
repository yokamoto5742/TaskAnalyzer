# 業務分析アプリ

## 概要
業務分析アプリは、日々の業務内容と時間を記録したWILLDOリストを分析し、業務内容の集計を行うツールです。
クラーク業務、デイリータスク、コミュニケーションなど、様々な観点から業務時間の分析が可能です。

## 動作要件
- Python 3.11以上
- Windows OS
- 必要なPythonパッケージ:
  - tkcalendar
  - polars
  - openpyxl
  - pyarrow

## インストール方法
1. リポジトリをクローンまたはダウンロードします
2. 必要なパッケージをインストールします：
```bash
pip install tkcalendar polars openpyxl pyarrow
```

## アプリケーションの構成
- `main.py`: アプリケーションのエントリーポイント
- `app_window.py`: GUIの実装
- `service_analysis.py`: 分析ロジックの実装

## 使用方法
1. アプリケーションの起動：
```bash
python main.py
```

2. GUIで分析期間（開始日・終了日）を選択します
3. 「分析開始」ボタンをクリックすると分析が実行されます
4. 分析結果は指定された出力フォルダにExcelファイルとして保存されます

## 設定ファイル
設定ファイルには以下の項目を定義する必要があります：

### [PATHS]セクション
- `input_file_path`: WILLDOリストのExcelファイルパス
- `template_path`: 出力テンプレートのパス
- `output_dir`: 分析結果の出力先ディレクトリ
- `config_path`: 設定ファイルのパス

### [Analysis]セクション
- `start_row`: 業務データの開始行
- `end_row`: 業務データの終了行
- `daily_task_start_row`: デイリータスクの開始行
- `daily_task_end_row`: デイリータスクの終了行
- `communication_start_row`: コミュニケーションデータの開始行
- `communication_end_row`: コミュニケーションデータの終了行

### [Appearance]セクション
- `window_width`: ウィンドウの幅
- `window_height`: ウィンドウの高さ

## 分析結果
分析結果は以下の項目を含むExcelファイルとして出力されます：

1. クラーク業務の集計
2. クラーク以外の業務の集計
3. デイリータスクの集計
4. コミュニケーション内容の集計
5. 全項目の集計

## 開発者向け情報
### コードの構成
- `TaskAnalyzerGUI`: GUIの作成と管理を担当
- `TaskAnalyzer`: Excelファイルの読み込みと分析を担当

### 拡張方法
1. 新しい分析項目の追加
   - `service_analysis.py`の`analyze_tasks`メソッドに新しい分析ロジックを追加
   - テンプレートExcelファイルに新しいシートを追加

2. GUIの拡張
   - `app_window.py`の`_setup_gui`メソッドを修正

## トラブルシューティング
1. アプリケーションが起動しない
   - Python 3.11以上がインストールされているか確認
   - 必要なパッケージがすべてインストールされているか確認

2. 分析が実行されない
   - 設定ファイルの内容が正しいか確認
   - 入力ファイルが指定されたパスに存在するか確認
   - 入力ファイルの形式が正しいか確認

3. エラーメッセージが表示される
   - エラーメッセージの内容を確認
   - 設定ファイルの値が正しいか確認
   - 入力ファイルの内容が正しい形式か確認

## ライセンス
このプロジェクトのライセンス情報については、LICENSEファイルを参照してください。
